/**
 * JavaScript for PHPMaker 11
 * @license (C)2002-2014 e.World Technology Ltd.
 */function ew_DefaultLookup(e, t){var n = t.data, r = t.parents; for (var i = 0, s = r.length; i < s; i++){var o = r[i]; if (!o.length)return t.valid = !1; var u = n[5 + i]; if (!jQuery.isUndefined(u) && ew_InArray(u, o) < 0)return t.valid = !1}}function ew_InitIcons(){var e = jQuery; e(".ewIcon").closest("a, button").add(".ewTooltip").tooltip({container:"body", trigger:EW_IS_MOBILE?"manual":"hover", placement:"bottom"})}function ew_On(e, t, n){var r = jQuery, i; r.isString(e)?i = /^\w+(\[\])?$/.test(e)?r("[id='" + e + "'],[name='" + e + "']"):r(e):i = r(e), i.on(t, n)}function ew_Batch(e, t, n, r){var i = jQuery, s = [], o = r?n:null; e = e && (e.tagName || e.item)?e:i(e).get(); if (!e || !t)return!1; if (e.tagName || e.length === undefined)return t.call(o, e, n); for (var u = 0; u < e.length; ++u)s[s.length] = t.call(o || e[u], e[u], n); return s}function ew_Select(e, t, n){var r = jQuery, i = r(t), s = i.find(e).get(); return r.isFunction(n)?s = ew_Batch(s, n):r.isString(n) && (s = ew_Batch(s, new Function(n))), s}function ew_Matches(e, t, n){var r = jQuery, i = r(t).filter(e).get(); return r.isFunction(n)?i = ew_Batch(i, n):r.isString(n) && (i = ew_Batch(i, new Function(n))), i}function ew_Page(e){this.Name = e, this.PageID = ""}function ew_Form(e){var t = jQuery; this.ID = e, this.$Element = null, this.Form = null, this.InitSearchPanel = !1, this.SrchOprChanged = function(e){var n = this.GetForm(), r = t(n), i = t.isString(e)?n.elements[e]:e; if (!i)return; var s = i.id.substr(2), o = t(i).val(), u = o == "BETWEEN", a = o == "IS NULL" || o == "IS NOT NULL"; /^z_/.test(i.id) && r.find("[name^=x_" + s + "],[name^=cal_x_" + s + "]").prop("disabled", a), /^w_/.test(i.id) && r.find("[name^=y_" + s + "],[name^=cal_y_" + s + "]").prop("disabled", a), r.find("span.btw0_" + s).toggle(!u).end().find("span.btw1_" + s).toggle(u).find(":input").prop("disabled", !u)}, this.ValidateRequired = !0, this.Validate = null, this.DisableForm = function(){if (!EW_DISABLE_BUTTON_ON_SUBMIT)return; var e = this.GetForm(); t(e).find(":submit").prop("disabled", !0).addClass("disabled")}, this.EnableForm = function(){if (!EW_DISABLE_BUTTON_ON_SUBMIT)return; var e = this.GetForm(); t(e).find(":submit").prop("disabled", !1).removeClass("disabled")}, this.Submit = function(e){var n = this.GetForm(), r = t(n); this.DisableForm(), this.UpdateTextArea(); if (!this.Validate || this.Validate()){e && (n.action = e), r.find("input[name^=s_],input[name^=sv_],input[name^=q_],.ewTemplate input").prop("disabled", !0); var i = t(r.find("input[name='detailpage']").map(function(e, t){return r.find("#" + t.value).get()})); i.length > 1 && i.each(function(e, n){t(n).find(":input").each(function(e, s){if (/^(fn_)?(x|o)\d*_/.test(s.name)){var o = i.not(n).find(":input[name='" + s.name + "']"); if (o.length){var u = t(s).serializeArray(); t.each(u, function(e, i){t("<input type='hidden' name='" + n.id + "$" + s.name + "'>").val(i.value).appendTo(r)})}}})}), n.submit()} else this.EnableForm(); return!1}, this.EmptyRow = null, this.MultiPage = null, this.Lists = {}, this.AutoSuggests = {}, this.GetForm = function(){return this.Form || (this.$Element = t("#" + this.ID), this.$Element.is("form")?this.Form = this.$Element[0]:this.$Element.is("div") && (this.Form = this.$Element.closest("form")[0])), this.Form}, this.GetElements = function(e){var t = "[name='" + e + "']"; t = "input" + t + ",select" + t + ",textarea" + t + ",button" + t; var n = this.$Element.find(t); return n.length == 0?null:n.length == 1 && n.is(":not(:checkbox):not(:radio)")?n[0]:n.get()}, this.PostAutoSuggest = function(){}, this.UpdateOpts = function(e){if (e === $rowindex$)return; var n = [], r = this.GetForm(); for (var i in this.Lists){var s = this.Lists[i].ParentFields.slice(), o = this.Lists[i].Ajax; if (t.isValue(e)){i = i.replace(/^x_/, "x" + e + "_"); for (var u = 0, a = s.length; u < a; u++)s[u] = s[u].replace(/^x_/, "x" + e + "_")}if (o){var f = []; for (var u = 0, a = s.length; u < a; u++)f[f.length] = ew_GetOptValues(s[u], r); n[n.length] = [i, f, !0, !1]} else ew_UpdateOpt.call(this, i, s, null, !1)}for (var u = 0, l = n.length; u < l; u++)ew_UpdateOpt.apply(this, n[u])}, this.CreateAutoSuggest = function(e, t){this.AutoSuggests[e] = new ew_AutoSuggest(e, this, t)}, this.CreateEditor = function(e){var n = this.GetForm(); t(n.elements).filter("textarea.editor").each(function(n, r){var i = t(r).data("editor"); if (!i || i.active || i.name.indexOf("$rowindex$") > - 1 || e && i.name != e)return!0; i.create(); if (e)return!1})}, this.UpdateTextArea = function(e){var n = this.GetForm(); t(n.elements).filter("textarea.editor").each(function(n, r){var i = t(r).data("editor"); if (!i || e && i.name != e)return!0; i.save(); if (e)return!1})}, this.DestroyEditor = function(e){var n = this.GetForm(); t(n.elements).filter("textarea.editor").each(function(n, r){var i = t(r).data("editor"); if (!i || e && i.name != e)return!0; i.destroy(); if (e)return!1})}, this.OnError = function(e, t){return ew_OnError(this, e, t)}, this.InitUpload = function(){var e = this.GetForm(); t(e.elements).filter("input:file").each(ew_Upload)}, this.Init = function(){var e = this, n = this.GetForm(), r = t(n); if (!n)return; var i = /s(ea)?rch$/.test(this.ID); i && this.InitSearchPanel && !ew_HasFormData(n) && t("#" + this.ID + "_SearchPanel").removeClass("in"), t(".ewSearchToggle[data-form=" + this.ID + "]").on("click.bs.button", function(){t("#" + t(this).data("form") + "_SearchPanel").collapse("toggle")}), i && t(".ewHighlight[data-form=" + this.ID + "]").on("click.bs.button", function(){t("span." + t(this).data("name")).toggleClass("ewHighlightSearch")}), i && r.find("select[id^=z_]").each(function(){var e = t(this).change(); e.val() != "BETWEEN" && r.find("#w_" + this.id.substr(2)).change()}), this.MultiPage && this.MultiPage.Render(this.ID), this.CreateEditor(), this.UpdateOpts(), this.InitUpload(), this.$Element.is("form") && r.submit(function(t){return e.Submit()}), this.$Element.data("form", this)}, ewForms[this.ID] = this}function ew_GetForm(e){var t = jQuery, n = t(e), r = n.closest(".ewForm"); return r[0] || (r = n.closest(".ewGrid,.ewMultiColumnGrid").find(".ewForm")), r[0]}function ew_HasFormData(e){var t = jQuery, n = t(e).find("[name^=x_][value!=''],[name^=y_][value!=''],[name^=z_],[name^=w_],[name='psearch'][value!='']").get(); for (var r = 0, i = n.length; r < i; r++){var s = n[r]; if (/^(z|w)_/.test(s.name)){if (/^IS/.test(t(s).val()))return!0} else if (s.type == "checkbox" || s.type == "radio"){if (s.checked)return!0} else if (s.type == "select-one" || s.type == "select-multiple"){if (!!t(s).val())return!0} else if (s.type == "text" || s.type == "hidden" || s.type == "textarea")return!0}return!1}function ew_SetSearchType(e, t){var n = jQuery, r = n(e), i = r.closest("form"), s = ""; return i.find("input[name=psearchtype]").val(t || ""), t == "="?s = ewLanguage.Phrase("QuickSearchExactShort"):t == "AND"?s = ewLanguage.Phrase("QuickSearchAllShort"):t == "OR"?s = ewLanguage.Phrase("QuickSearchAnyShort"):s = ewLanguage.Phrase("QuickSearchAutoShort"), i.find("#searchtype").html(s + (s?"&nbsp;":"")), r.closest("ul").find("li").removeClass("active"), r.closest("li").addClass("active"), !1}function ew_UpdateOpt(e, t, n, r){var i = jQuery, s = this, o = i(this), u = function(){o.dequeue()}; if (!e || i.isArray(e) && e.length == 0)return u(); var a = this.Form?this.Form:this.form?this.form:null; this.form && /^x\d+_/.test(this.id) && (a = ew_GetForm(this)); if (!a)return u(); var f = this.Form?this:ewForms[a.id]; if (!f)return u(); var l = i.makeArray(arguments); if (this.form && i.isArray(e) && i.isString(e[0])){for (var c = 0, h = e.length; c < h; c++)o.queue(i.proxy(ew_UpdateOpt, s, e[c], t, n, r)); var p = f.Lists[this.id.replace(/^[xy]\d*_/, "x_")]; return p && p.AutoFill && o.queue(function(){ew_AutoFill(s)}), u()}i.isString(e) && (e = f.GetElements(e)); if (!e || i.isArray(e) && e.length == 0)return u(); var d = ew_GetOptValues(e), v = ew_GetId(e, !1); if (!v)return u(); var m = v.replace(/^([xy])(\d*)_/, "x_"), g = RegExp.$1, y = RegExp.$2, b = []; if (i.isUndefined(t)){t = f.Lists[m].ParentFields.slice(); if (y != "")for (var c = 0, h = t.length; c < h; c++)t[c] = t[c].replace(/^x_/, "x" + y + "_");  else g == "y"}if (i.isArray(t) && t.length > 0)if (i.isArray(t[0]))b = t;  else if (i.isString(t[0]))for (var c = 0, h = t.length; c < h; c++)b[b.length] = ew_GetOptValues(t[c], a); ew_IsAutoSuggest(e) || ew_ClearOpt(e); var w = function(t){for (var n = 0, s = t.length; n < s; n++){var o = {data:t[n], parents:b, valid:!0, name:ew_GetId(e), form:a}; i(document).trigger("addoption", [o]), o.valid && ew_NewOpt(e, t[n], a)}!e.options && e.length && (ew_RenderOpt(e), e = ew_GetElements(v, a)), ew_SelectOpt(e, d), r !== !1 && (!e.options && e.length?i(e).first().click():i(e).first().change())}; i.isUndefined(n) && (n = f.Lists[m].Ajax); if (!i.isBoolean(n)){var E = f.Lists[m].Options; return w(E), /s(ea)?rch$/.test(a.id) && g == "x" && (l[0] = v.replace(/^x_/, "y_"), ew_UpdateOpt.apply(this, l)), u()}var S = ew_GetId(e), x = i(a).find("#s_" + S).val(); if (!x)return u(); x += "&type=updateopt&name=" + S, ew_IsAutoSuggest(e) && this.Form && (x += "&v0=" + (d[0]?encodeURIComponent(d[0]):ew_Random())); for (var c = 0, T = b.length; c < T; c++)x += "&v" + (c + 1) + "=" + encodeURIComponent(b[c].join(",")); x += "&token=" + EW_TOKEN, i.post(EW_LOOKUP_FILE_NAME, x, function(e){w(e || [])}, "json").always(function(){o.dequeue()}), /s(ea)?rch$/.test(a.id) && g == "x" && (l[0] = v.replace(/^x_/, "y_"), ew_UpdateOpt.apply(this, l))}function ew_Language(e){this.obj = e, this.Phrase = function(e){return this.obj[e.toLowerCase()]}}function ew_ApplyTemplate(e, t, n, r, i){var s = jQuery, o = s("#" + t); if (!s.views || !o[0])return; o.attr("type") || o.attr("type", "text/html"); var u = {data:i || {}, id:e, template:t, filename:n, "export":r, enabled:!0}; s(document).trigger("rendertemplate", [u]), u.enabled && s("#" + e).html(o.render(u.data)), r && r != "print" && s(function(){var t = s("meta[http-equiv='Content-Type']"), n = "<html><head>", i = s("#" + e); t[0] && (n += "<meta http-equiv='Content-Type' content='" + t.attr("content") + "'>"), r == "pdf"?(n += "<link rel='stylesheet' type='text/css' href='" + EW_PDF_STYLESHEET_FILENAME + "'>", i.children(0).is("div[id^=ct_]") && (i = i.children(0))):n += "<style>" + s.ajax({async:!1, type:"GET", url:EW_PROJECT_STYLESHEET_FILENAME}).responseText + "</style>", n += "</head><body>" + i.html() + "</body></html>"; var o = window.location.href.split("?")[0]; if (r == "email"){var a = window.location.search.replace(/^\?/, "") + "&" + s.param({customexport:r, data:n, filename:u.fileName}); a += "&token=" + EW_TOKEN, s.post(o, a, function(e){ew_ShowMessage(e)})} else s("<form>").attr({method:"post", action:o}).append(s("<input type='hidden'>").attr({name:"customexport", value:r}), s("<input type='hidden'>").attr({name:"data", value:n}), s("<input type='hidden'>").attr({name:"filename", value:u.fileName})).appendTo("body").submit(); window.location != window.parent.location && window.parent.jQuery && window.parent.jQuery("body").css("cursor", "default")})}function ew_RenderTemplate(e){var t = jQuery, n = t("#" + e); if (!t.views || !n[0])return; n.attr("type") || n.attr("type", "text/html"); var r = {data:{}, template:e}; return t(document).trigger("rendertemplate", [r]), n.render(r.data)}function ew_ShowTemplates(e){var t = jQuery; t("script" + (e?"." + e:"") + "[type='text/html']").each(function(){$scr = t(this), /^\s*(<td[\s\S]*>[\s\S]*<\/td>)\s*$/i.test($scr.html())?$scr.next().before(t("<table><tr>" + RegExp.$1 + "</tr></table>").find("tr:first > td")):t(this).after(t("<span></span>").addClass($scr.attr("class")).html($scr.html())), $scr.closest(".ewTable").show(), $scr.closest(".ewGrid").show()})}function ew_ConvertToBool(e){return ew_InArray(e.toLowerCase(), ["1", "y", "t"]) > - 1}function ew_ValueChanged(e, t, n, r){var i = jQuery, s = ew_GetElements("x" + t + "_" + n, e), o = ew_GetElement("o" + t + "_" + n, e), u = ew_GetElement("fn_x" + t + "_" + n, e); if (!o && (!s || i.isArray(s) && s.length == 0))return!1; var a = function(e){return ew_GetOptValues(e).join(",")}; if (o && s)if (r){if (ew_ConvertToBool(a(o)) === ew_ConvertToBool(a(s)))return!1} else{var f = a(o), l = u?a(u):a(s); if (f == l)return!1}return!0}function ew_ReadOnlyTextArea(e, t, n){if (!e || !e.parentNode)return; var r = jQuery, i = r(e).hide().prop("readOnly", !0), s = r("<div></div>").addClass("ewReadOnlyTextArea").width(t).height(n).appendTo(i.parent()), o = r("<div></div>").addClass("ewResizeHandle").appendTo(s), u = r("<div></div>").html(i.val()).addClass("ewReadOnlyTextAreaData uneditable-textarea").appendTo(s); u.height(s.height() - 5), s.drag("start", function(e, t){t.width = r(this).width(), t.height = r(this).height()}).drag(function(e, t){r(this).css({width:Math.max(20, t.width + t.deltaX), height:Math.max(20, t.height + t.deltaY)}), u.height(s.height() - 5)}, {handle:".ewResizeHandle"})}function ew_Get(e, t){t = t || window.location.search; var n = /(?:\?|&)([^&=]+)=?([^&]*)/g, r = /\+/g, i = function(e){return decodeURIComponent(e.replace(r, " "))}, s = {}, o; while (o = n.exec(t)){var u = i(o[1]), a = i(o[2]); u.substring(u.length - 2) === "[]" && (u = u.substring(0, u.length - 2)), (s[u] || (s[u] = [])).push(a)}return s[e]}function ew_SetLanguage(e){var t = jQuery, n = t(e).val(); if (!n)return; var r = window.location.href; if (window.location.search){var i = window.location.search, s = {}; i.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g, function(e, t, n){t && (s[t] = n)}), s.language = encodeURIComponent(n); var o = "?"; for (var u in s)o += u + "=" + s[u] + "&"; o = o.substr(0, o.length - 1); var a = r.lastIndexOf(window.location.search); r = r.substr(0, a) + o} else r += "?language=" + encodeURIComponent(n); window.location = r}function ew_SubmitSelected(e, t, n, r){if (!e)return; if (!ew_KeySelected(e))alert(ewLanguage.Phrase("NoRecordSelected"));  else if (n?ew_Confirm(n):!0){var i = jQuery, s = i(e); r && i("<input>").attr({type:"hidden", name:"useraction"}).val(r).appendTo(s), s.prop("action", t).submit()}}function ew_Export(e, t, n, r, i, s){if (!e)return; var o = jQuery, u = o(e), a = u.attr("target"), f = u.attr("action"), l = i && u.find("input:checkbox[name='key_m[]']")[0]; if (l && !ew_KeySelected(e)){alert(ewLanguage.Phrase("NoRecordSelected")); return}if (r){o("iframe.ewExport").remove(), n == "email" && (t += ("&" + o(s).serialize()).replace(/&export=email/i, "")); if (l){o("<iframe>").attr("name", "ewExportFrame").addClass("ewExport hide").appendTo(o("body").css("cursor", "wait")); try{u.append(o("<input type='hidden'>").attr({name:"custom", value:"1"})).attr({action:t, target:"ewExportFrame"}).find("input[name=exporttype]").val(n).end().submit()} finally{u.attr({target:a || "", action:f}).find("input[name=custom]").remove()}} else o("<iframe>").attr({name:"ewExportFrame", src:t}).addClass("ewExport hide").appendTo(o("body").css("cursor", "wait")); o.later(5e3, null, function(){o("body").css("cursor", "default")})} else u.find("input[name=exporttype]").val(n).end().submit()}function ew_RemoveSpaces(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g, ""))?"":e}function ew_IsHiddenTextArea(e){var t = jQuery, n = t(e); return e && n.is(":hidden") && n.data("editor")}function ew_IsAutoSuggest(e){var t = jQuery, n = t(e); return e && n.is(":hidden") && n.data("autosuggest")}function ew_GetAutoSuggest(e){return ewForms(e).AutoSuggests[e.id]}function ew_OnError(e, t, n){alert(n); if (e)if (e.MultiPage)e.MultiPage.GotoPageByElement(t);  else if (e.$Element.is("div")){var r = e.$Element.closest(".tab-pane"); r[0] && !r.hasClass("active") && r.closest(".tabbable").find("a[data-toggle=tab][href='#" + r.attr("id") + "']").click()}return jQuery.later(100, this, "ew_SetFocus", t), !1}function ew_SetFocus(e){if (!e)return; var t = jQuery, n = t(e); if (ew_IsHiddenTextArea(e))return n.data("editor").focus(); !e.options && e.length?e = n.filter("[value!='{value}']")[0]:ew_IsAutoSuggest(e) && (e = ew_GetAutoSuggest(e).input); var r = n.closest(".form-group,[id^='el_']").addClass("has-error"); n.focus().select().one("click keypress", function(){r.removeClass("has-error")})}function ew_HasValue(e){return ew_GetOptValues(e).join("") != ""}function ew_Sort(e, t, n){return n == 2 && e.ctrlKey && (t += "&ctrl=1"), location = t, !0}function ew_Confirm(e){return confirm(e)}function ew_ConfirmDelete(e, t){var n = confirm(e); return n || ew_ClearDelete(t), n}function ew_KeySelected(e){return jQuery(e).find("input:checkbox[name='key_m[]']:checked", e).length > 0}function ew_SelectAllKey(e){ew_SelectAll(e); var t = jQuery, n = t(e).closest("." + EW_TABLE_CLASSNAME)[0]; if (!n)return; t(n.tBodies).each(function(){t(this.rows).each(function(n, r){var i = t(r); i.is(":not(." + EW_ITEM_TEMPLATE_CLASSNAME + "):not(." + EW_TABLE_PREVIEW_ROW_CLASSNAME + ")") && (i.data({selected:e.checked, checked:e.checked}), ew_SetColor(n, r))})})}function ew_SelectAll(e){if (!e || !e.form)return; $(e.form.elements).filter("input:checkbox[name^=" + e.name + "_], :checkbox[name=" + e.name + "]").not(e).prop("checked", e.checked)}function ew_UpdateSelected(e){return jQuery(e).find("input:checkbox[name^=u_]:checked").length > 0}function ew_AddClass(e, t){var n = jQuery, r = n(e); r.data("bgcolor") || r.data("bgcolor", r.css("backgroundColor")), r.data("color") || r.data("color", r.css("color")), r.css("backgroundColor", "").css("color", "").addClass(t)}function ew_RemoveClass(e, t){var n = jQuery, r = n(e).removeClass(t); r.data("bgcolor") && r.css("backgroundColor", r.data("bgcolor")), r.data("color") && r.css("color", r.data("color"))}function ew_UpdateRow(e, t){var n = jQuery, r = n(e), i = r.data("rowindex"); if (!e || !n.isFunction(t))return; t( - 1, e), i && (r.prevUntil("tr[data-rowindex!='" + i + "']").each(t), r.nextUntil("tr[data-rowindex!='" + i + "']").each(t))}function ew_MouseOver(e){var t = jQuery, n = t(this); if (!n.data("selected") && ew_InArray(n.data("rowtype"), [EW_ROWTYPE_ADD, EW_ROWTYPE_EDIT]) == - 1){var r = n.closest("." + EW_TABLE_CLASSNAME); if (!r[0])return; ew_UpdateRow(this, function(e, n){t(n).addClass(r.data("rowhighlightclass") || EW_TABLE_HIGHLIGHT_ROW_CLASSNAME)})}}function ew_MouseOut(e){var t = jQuery, n = t(this); !n.data("selected") && ew_InArray(n.data("rowtype"), [EW_ROWTYPE_ADD, EW_ROWTYPE_EDIT]) == - 1 && ew_UpdateRow(this, ew_SetColor)}function ew_Click(e){var t = jQuery, n = t(this), r = n.closest("." + EW_TABLE_CLASSNAME)[0], i = t(e.target); if (!r || i.hasClass("btn") || i.hasClass("ewPreviewRowBtn") || i.is(":input"))return; if (!n.data("checked")){var s = n.data("selected"); ew_ClearSelected(r), ew_UpdateRow(this, function(e, n){t(n).data("selected", !s), ew_SetColor(e, n)})}}function ew_SetColor(e, t){var n = jQuery, r = n(t), i = r.closest("." + EW_TABLE_CLASSNAME); if (!i[0])return; r.data("selected")?r.removeClass(i.data("rowhighlightclass") || EW_TABLE_HIGHLIGHT_ROW_CLASSNAME).removeClass(i.data("roweditclass") || EW_TABLE_EDIT_ROW_CLASSNAME).addClass(i.data("rowselectclass") || EW_TABLE_SELECT_ROW_CLASSNAME):ew_InArray(r.data("rowtype"), [EW_ROWTYPE_ADD, EW_ROWTYPE_EDIT]) > - 1?r.removeClass(i.data("rowselectclass") || EW_TABLE_SELECT_ROW_CLASSNAME).removeClass(i.data("rowhighlightclass") || EW_TABLE_HIGHLIGHT_ROW_CLASSNAME).addClass(i.data("roweditclass") || EW_TABLE_EDIT_ROW_CLASSNAME):r.removeClass(i.data("rowselectclass") || EW_TABLE_SELECT_ROW_CLASSNAME).removeClass(i.data("roweditclass") || EW_TABLE_EDIT_ROW_CLASSNAME).removeClass(i.data("rowhighlightclass") || EW_TABLE_HIGHLIGHT_ROW_CLASSNAME)}function ew_ClearSelected(e){var t = jQuery; t(e.rows).each(function(e, n){var r = t(n); !r.data("checked") && r.data("selected") && (r.data("selected", !1), ew_SetColor(e, n))})}function ew_ClearDelete(e){var t = jQuery, n = t(e), r = n.closest("." + EW_TABLE_CLASSNAME)[0]; if (!r)return; ew_UpdateRow(n.closest(".ewTable > tbody > tr")[0], function(e, n){var r = t(n); r.data("selected", r.data("checked"))})}function ew_ClickDelete(e){var t = jQuery, n = t(e), r = n.closest("." + EW_TABLE_CLASSNAME)[0]; if (!r)return; ew_ClearSelected(r), ew_UpdateRow(n.closest(".ewTable > tbody > tr")[0], function(e, n){t(n).data("selected", !0), ew_SetColor(e, n)})}function ew_StopPropagation(e){e.stopPropagation?e.stopPropagation():e.cancelBubble = !0}function ew_ClickMultiCheckbox(e, t){var n = jQuery, r = n(t), i = r.closest("." + EW_TABLE_CLASSNAME)[0]; if (!i)return; ew_ClearSelected(i), ew_UpdateRow(r.closest(".ewTable > tbody > tr")[0], function(e, r){n(r).data("checked", t.checked).data("selected", t.checked).find("input:checkbox[name='key_m[]']").each(function(){this != t && (this.checked = t.checked)}), ew_SetColor(e, r)}), ew_StopPropagation(e)}function ew_SetupTable(e, t, n){var r = jQuery, i = r(t), s = r(t.rows); if (!t || !t.rows || !n && i.data("isset") || t.tBodies.length == 0)return; var o = s.filter("[data-rowindex=1]").length || s.filter("[data-rowindex=0]").length || 1, u = s.filter(":not(." + EW_ITEM_TEMPLATE_CLASSNAME + "):not(:hidden)").each(function(){r(this.cells).removeClass(EW_TABLE_LAST_ROW_CLASSNAME).last().addClass(EW_TABLE_LAST_COL_CLASSNAME)}).get(), a = i.parentsUntil(".ewGrid", ".table-responsive")[0]; if (u.length)for (var f = 1; f <= o; f++){var l = u[u.length - f]; r(l.cells).each(function(){this.rowSpan == f && r(this).addClass(EW_TABLE_LAST_ROW_CLASSNAME).toggleClass(EW_TABLE_BORDER_BOTTOM_CLASSNAME, !!a && a.clientHeight > t.offsetHeight)})}var c = i.closest("form")[0], h = c && r(c.elements).filter("input#a_list:not([value^=grid])").length > 0; r(t.tBodies[t.tBodies.length - 1].rows).filter(":not(." + EW_ITEM_TEMPLATE_CLASSNAME + "):not(." + EW_TABLE_PREVIEW_ROW_CLASSNAME + ")").each(function(e){var t = r(this); h && !t.data("isset") && (ew_InArray(t.data("rowtype"), [EW_ROWTYPE_ADD, EW_ROWTYPE_EDIT]) > - 1 && t.on("mouseover", function(){this.edit = !0}).addClass(EW_TABLE_EDIT_ROW_CLASSNAME), t.on("mouseover", ew_MouseOver).on("mouseout", ew_MouseOut).on("click", ew_Click), t.data("isset", !0)); var n = e % (2 * o) < o; t.toggleClass(EW_TABLE_ROW_CLASSNAME, n).toggleClass(EW_TABLE_ALT_ROW_CLASSNAME, !n)}), ew_SetupGrid(e, i.closest("." + EW_GRID_CLASSNAME)[0], n), i.data("isset", !0)}function ew_SetupGrid(e, t, n){var r = jQuery, i = r(t); if (!t || !n && i.data("isset"))return; var s = i.find("table.ewMultiColumnTable").length, o; s?o = i.find("td[data-rowindex]").length:o = i.find("table." + EW_TABLE_CLASSNAME + " > tbody:first > tr:not(." + EW_TABLE_PREVIEW_ROW_CLASSNAME + ", ." + EW_ITEM_TEMPLATE_CLASSNAME + ")").length, o == 0 && !i.find(".ewGridUpperPanel, .ewGridLowerPanel")[0] && i.hide(), i.data("isset", !0)}function ew_AddGridRow(e){var t = jQuery, n = t(e).closest("." + EW_GRID_CLASSNAME), r = n.find("table." + EW_TABLE_CLASSNAME), i = r.find("tr." + EW_ITEM_TEMPLATE_CLASSNAME); if (!e || !n[0] || !r[0] || !i[0])return; var s = t(r[0].rows).last(); r.find("td." + EW_TABLE_LAST_ROW_CLASSNAME).removeClass(EW_TABLE_LAST_ROW_CLASSNAME); var o = i.clone(!0).removeClass(EW_ITEM_TEMPLATE_CLASSNAME), u = n.find("div.ewForm[id^=f][id$=grid]"); u[0] || (u = n.find("form.ewForm[id^=f][id$=list]")); var a = u.is("div")?"_" + u.attr("id"):"", f = u.find("#key_count" + a), l = parseInt(f.val(), 10) + 1; o.attr({id:"r" + l + o.attr("id").substring(2), "data-rowindex":l}); var c = i.find("script:contains('$rowindex$')"); o.children("td").each(function(){this.innerHTML = this.innerHTML.replace(/\$rowindex\$/g, l)}), o.find(".ewIcon").closest("a, button").tooltip("destroy").tooltip({container:"body", placement:"bottom", trigger:"hover"}), f.val(l).after(t("<input>").attr({type:"hidden", id:"k" + l + "_action" + a, name:"k" + l + "_action" + a, value:"insert"})), s.after(o); var h = u.data("form"); h && (h.CreateEditor(), h.InitUpload()), c.each(function(){ew_AddScript(this.text.replace(/\$rowindex\$/g, l))}), ew_SetupTable( - 1, r[0], !0)}function ew_DeleteGridRow(e, t){var n = jQuery, r = n(e).tooltip("destroy"), i = r.closest("." + EW_GRID_CLASSNAME + ", ." + EW_MULTI_COLUMN_GRID_CLASSNAME), s = r.closest("tr, div[data-rowindex]"), o = s.closest("." + EW_TABLE_CLASSNAME); if (!e || !i[0] || !s[0])return; var u = parseInt(s.data("rowindex"), 10), a = i.find("div.ewForm[id^=f][id$=grid]"); a[0] || (a = i.find("form.ewForm[id^=f][id$=list]")); var f = a.data("form"); if (!a[0] || !f)return; var l = a.is("div")?"_" + a.attr("id"):"", c = "#key_count" + l, h = a.find(c), p = n.isFunction(f.EmptyRow)?!f.EmptyRow(t):!0; if (p && !confirm(ewLanguage.Phrase("DeleteConfirmMsg")))return; s.remove(), i.is("." + EW_GRID_CLASSNAME) && ew_SetupTable( - 1, o[0], !0); if (u > 0){var d = a.find("#k" + u + "_action" + l); return d[0]?d.val(d.val() == "insert"?"insertdelete":"delete"):a.find(c).after(n("<input>").attr({type:"hidden", id:"k" + u + "_action" + l, name:"k" + u + "_action" + l, value:"delete"})), !0}return!1}function ew_HtmlEncode(e){var t = String(e); return t = t.replace(/&/g, "&amp"), t = t.replace(/\"/g, "&quot;"), t = t.replace(/</g, "&lt;"), t = t.replace(/>/g, "&gt;"), t}function ew_ClearForm(e){var t = jQuery; t(e).find("[id^=x_],[id^=y_]").each(function(){if (this.type == "checkbox" || this.type == "radio")this.checked = !1;  else if (this.type == "select-one")this.selectedIndex = 0;  else if (this.type == "select-multiple")t(this).find("option").prop("selected", !1);  else if (this.type == "text" || this.type == "textarea" || this.type == "hidden" && ew_IsAutoSuggest(this))this.value = "", this.type == "hidden" && (ew_GetAutoSuggest(this).input.value = "")})}function ew_MultiPage(e, t){var n = jQuery, r = this; this.FormID = e, this.PageIndex = 1, this.MaxPageIndex = 0, this.MinPageIndex = 0, this.Elements = t || [], this.$Pages = null, this.SubmitButton = null, this.LastPageSubmit = !1, this.HideDisabledButton = !0, this.Init = function(){n.each(this.Elements, function(e, t){t[1] > r.MaxPageIndex && (r.MaxPageIndex = t[1])}), this.MinPageIndex = this.MaxPageIndex, n.each(this.Elements, function(e, t){t[1] < r.MinPageIndex && (r.MinPageIndex = t[1])})}, this.ShowPage = function(){this.EnableButtons()}, this.EnableButtons = function(){if (this.SubmitButton){var e = n(this.SubmitButton), t = this.LastPageSubmit && this.PageIndex != this.MaxPageIndex || !1; e.prop("disabled", t).toggleClass("disabled", t), e.prop("disabled") && this.HideDisabledButton?e.hide():e.show()}}, this.GetPageIndexByElementId = function(e){for (var t = 0, n = this.Elements.length; t < n; t++)if (this.Elements[t][0] == e)return this.Elements[t][1]; return - 1}, this.GotoPageByIndex = function(e){if (e < this.MinPageIndex || e > this.MaxPageIndex)return; this.PageIndex != e && this.$Pages.eq(e - 1).click()}, this.GotoPageByElement = function(e){if (!e)return; var t = !e.type && e[0]?e[0].name:e.name; if (t == "")return; var n = this.GetPageIndexByElementId(t); n > 0 && this.GotoPageByIndex(n)}, this.Render = function(e){var t = jQuery, n = this, r = t("#" + e); n.Init(), n.SubmitButton = r.find("#btnAction")[0]; var i = r.find("[data-toggle=tab]"); if (i[0]){this.$Pages = i, i.on("shown.bs.tab", function(e){n.PageIndex = i.index(e.target) + 1, n.ShowPage(), t(t(this).attr("href")).find(".ewGoogleMap").each(function(){var e = ewGoogleMaps[this.id]; e && e.map && (google.maps.event.trigger(e.map, "resize"), e.map.setCenter(e.latlng))})}).each(function(){if (t(this).parent("li").hasClass("active"))return n.PageIndex = i.index(this) + 1, n.ShowPage(), !1}); return}var s = r.find("[data-toggle=collapse]"); if (s[0]){this.$Pages = s; var o = s.closest(".panel-heading").next(); o.on("shown.bs.collapse", function(e){n.PageIndex = o.index(e.target) + 1, n.ShowPage(), t(this).find(".ewGoogleMap").each(function(){var e = ewGoogleMaps[this.id]; e && e.map && (google.maps.event.trigger(e.map, "resize"), e.map.setCenter(e.latlng))})}).each(function(){if (t(this).hasClass("in"))return n.PageIndex = o.index(this) + 1, n.ShowPage(), !1})}}}function ew_GetElements(e, t){var n = jQuery, t = n.isString(t)?"#" + t:t, r = "[name='" + e + "']"; r = "input" + r + ",select" + r + ",textarea" + r + ",button" + r; var i = t?n(t).find(r):n(r); return i.length == 1 && i.is(":not(:checkbox):not(:radio)")?i[0]:i.get()}function ew_GetElement(e, t){var n = jQuery, t = n.isString(t)?"#" + t:t, r = "#" + e.replace(/([\$\[\]])/g, "\\$1") + ",[name='" + e + "']"; return t?n(t).find(r)[0]:n(r).first()[0]}function ew_GetAncestorBy(e, t){while (e = e.parentNode)if (e && e.nodeType == 1 && (!t || t(e)))return e; return null}function ew_IsHidden(e){var t = jQuery; return t(e).css("display") == "none" && !ew_IsHiddenTextArea(e) || ew_GetAncestorBy(e, function(e){var n = t(e); return n.css("display") == "none" && !n.hasClass("tab-pane") && !n.hasClass("collapse")}) != null}function ew_SameText(e, t){return String(e).toLowerCase() == String(t).toLowerCase()}function ew_SameStr(e, t){return String(e) == String(t)}function ew_InArray(e, t){if (!t)return - 1; for (var n = 0, r = t.length; n < r; n++)if (ew_SameStr(t[n], e))return n; return - 1}function ew_GetOptValues(e, t){var n = jQuery, r = n.isString(e)?ew_GetElements(e, t):e; return r.options?n(r).find("option:selected[value!='']").map(function(){return this.value}).get():n.isNumber(r.length)?n(r).filter(":checked[value!='{value}']").map(function(){return this.value}).get():[r.value]}function ew_ClearOpt(e){if (e.options){var t = e.type == "select-multiple"?0:1; for (var n = e.length - 1; n >= t; n--)e.options[n] = null} else if (e.length){var r = jQuery, i = ew_GetId(e), s = ew_GetElement("dsl_" + i, e[0].form); r(s).data("options", []).find("table." + EW_ITEM_TABLE_CLASSNAME).remove()} else if (ew_IsAutoSuggest(e)){var o = ew_GetAutoSuggest(e); o._options = [], o.input.value = "", e.value = ""}}function ew_GetId(e, t){var n = jQuery, r = ""; return n.isString(e)?r = e:r = n(e).attr("name") || n(e).attr("id"), t !== !1 && /\[\]$/.test(r) && (r = r.substr(0, r.length - 2)), r}function ew_ValueSeparator(e, t){return", "}function ew_NewOpt(e, t, n){var r = jQuery, i = {data:t, id:ew_GetId(e), form:n}; r(document).trigger("newoption", [i]), t = i.data; var s = t[0], o = t[1]; for (var u = 2; u <= 4; u++)t[u] && t[u] != "" && (o != "" && (o += ew_ValueSeparator(u - 1, e)), o += t[u]); if (e.options)e.options[e.length] = new Option(o, s, !1, !1);  else if (e.length){var r = jQuery, a = r(ew_GetElement("dsl_" + ew_GetId(e), n)), f = a.data("options"); a[0] && f && (f[f.length] = {val:s, lbl:o})} else if (ew_IsAutoSuggest(e)){var l = ew_GetAutoSuggest(e); l._options[l._options.length] = {val:s, lbl:o}}return o}function ew_RenderOpt(e){var t = jQuery, n = ew_GetId(e), r = t(e).parent().parent().find("#dsl_" + n); if (!r[0] || !r.data("options"))return; var i = r.parent().find("#tp_" + n); if (!i[0])return; var s = {id:n, parent:r[0], template:i[0]}; t(document).trigger("renderoption", [s]); var o = parseInt(r.data("repeatcolumn"), 10) || 5, u = i.contents(), a = r.data("options"), f = u.attr("type"), l = t('<table class="' + EW_ITEM_TABLE_CLASSNAME + '"></table>'), c; if (a && a.length){for (var h = 0, p = a.length; h < p; h++){h % o == 0 && (c = t("<tr></tr>")); var d = u.clone(!0).val(a[h].val), v = t('<label class="' + f + '-inline">' + a[h].lbl + "</label>").prepend(d.attr("id", d.attr("id") + "_" + h)); t("<td></td>").append(v).appendTo(c); if (h % o == o - 1)l.append(c);  else if (h == p - 1){for (var m = h % o + 1; m < o; m++)c.append("<td></td>"); l.append(c)}}r.append(l)}r.data("options", [])}function ew_SelectOpt(e, t){function o(e){if (!n(e).data("autoselect"))return!1; var t = ew_GetForm(e); if (t){if (/s(ea)?rch$/.test(t.id))return!1; var r = e.id.replace(/^([xy])(\d*)_/, "x_"); return r in ewForms[t.id].Lists && ewForms[t.id].Lists[r].ParentFields.length == 0?!1:!0}return!1}if (!e || !t)return; var n = jQuery; if (e.options)n(e).val(t), e.type == "select-one" && e.selectedIndex == - 1 && (e.selectedIndex = 0);  else if (e.length)e.length == 1 && e[0].type == "checkbox" && e[0].value != "{value}"?e[0].checked = ew_ConvertToBool(e[0].value) === ew_ConvertToBool(t[0]):n(e).val(t);  else if (ew_IsAutoSuggest(e) && t.length == 1){var r = ew_GetAutoSuggest(e); for (var i = 0, s = r._options.length; i < s; i++)if (r._options[i].val == t[0]){e.value = r._options[i].val, r.input.value = r._options[i].lbl; break}} else e.type && (e.value = t.join(",")); if (e.options)e.type == "select-one" && e.options.length == 2 && !e.options[1].selected && o(e)?e.options[1].selected = !0:e.type == "select-multiple" && e.options.length == 1 && !e.options[0].selected && o(e) && (e.options[0].selected = !0);  else if (e.length)e.length == 2 && o(e[1]) && (e[1].checked = !0);  else if (ew_IsAutoSuggest(e)){var r = ew_GetAutoSuggest(e); r._options.length == 1 && o(e) && (e.value = r._options[0].val, r.input.value = r._options[0].lbl)}}function ew_AutoSuggest(e, t, n){var r = e.replace(/^[xy](\d*|\$rowindex\$)_/, "x_"), i = RegExp.$1, s = {typeahead:{}}; if (i == "$rowindex$")return s; var o = t.GetForm(), u = ew_GetElement("sv_" + e, o); if (!u)return s; var a = ew_GetElement("sc_" + e, o), f = ew_GetElement("q_" + e, o), l = t.Lists[r].ParentFields.slice(); for (var c = 0, h = l.length; c < h; c++)l[c] = l[c].replace(/^x_/, "x" + i + "_"); this.input = u, this.element = ew_GetElement(e, o), this.highlight = !0, this.hint = !0, this.minLength = 1, this.limit = EW_AUTO_SUGGEST_MAX_ENTRIES, this.templates = null, this._options = []; var p = this, d = jQuery, v = d(this.input), m = d(this.element); this.$input = v, this.formatResult = function(t){var n = t[1]; if (n){for (var r = 2; r <= 4; r++)n += t[r]?ew_ValueSeparator(r - 1, e) + t[r]:""; return n}return t[0]}, this.setValue = function(e){e = e || v.val(); var t = v.data("results")?d.map(v.data("results"), function(t, n){if (t["value"] == e)return n}):[]; if (t.length == 0){if (this._options && this._options.length && this._options[this._options.length - 1].lbl == e)return; if (n && e){v.typeahead("val", "").attr("placeholder", ewLanguage.Phrase("ValueNotExist")).parent().append('<span class="glyphicon glyphicon-warning-sign form-control-feedback"></span>').closest(".form-group,[id^='el_']").addClass("has-error has-feedback"), m.val("").change(); return}} else if (!/s(ea)?rch$/.test(o.id) || n){var r = t[0]; r > - 1 && (e = v.data("results")[r][0])}m.val(e).change()}, this.generateRequest = function(){var e = f.value; if (l.length > 0)for (var t = 0, n = l.length; t < n; t++){var r = ew_GetOptValues(l[t], o); e += "&v" + (t + 1) + "=" + encodeURIComponent(r.join(","))}return"type=autosuggest&name=" + this.element.name + "&" + e}, v.on("typeahead:selected", function(e, t){p.setValue(t.text)}).blur(function(e){var t = v.data("ttTypeahead"); if (t && t.dropdown.isOpen){var n = v.data("ttTypeahead").dropdown._getCursor().index(); if (n > - 1){var r = v.data("results")[n][1]; v.typeahead("val", r)}}p.setValue()}).focus(function(e){v.attr("placeholder", m.attr("placeholder")).closest(".form-group,[id^='el_']").removeClass("has-error has-feedback").find(".form-control-feedback").remove()}), m.data("autosuggest", this), d(function(){var n = {datumTokenizer:function(e){return Bloodhound.tokenizers.whitespace(e.value)}, queryTokenizer:Bloodhound.tokenizers.whitespace, limit:p.limit, remote:{url:EW_LOOKUP_FILE_NAME, replace:function(e, t){return this.ajax.data = p.generateRequest(), e + "?q=" + encodeURIComponent(t) + "&rnd=" + ew_Random()}, ajax:{type:"POST", data:p.generateRequest()}, filter:function(e){v.data("results", e || []); var t = d.map(v.data("results"), function(e){var t = e.value = p.formatResult(e); return{lf:e[0], df1:e[1], df2:e[2], df3:e[3], df4:e[4], value:t}}); return t}}}; m.trigger("bloodhound", [n]), p.engine = new Bloodhound(n), p.engine.initialize(); var r = [{highlight:p.highlight, minLength:p.minLength, hint:p.hint}, {name:t.ID + "-" + e, source:p.engine.ttAdapter(), templates:p.templates
}]; m.trigger("typeahead", [r]), v.typeahead.apply(v, r), v.off("blur.tt"), p.typeahead = v.data("ttTypeahead"), p.typeahead.$node.css("display", "").addClass("ewAutoSuggest")})}function ew_ExecScript(e, t){var n, r = 0, i = /<script([^>]*)>([\s\S]*?)<\/script\s*>/ig; while ((n = i.exec(e)) != null){var s = RegExp.$2; /(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1) && ew_AddScript(s, "scr_" + t + "_" + r++)}}function ew_StripScript(e){var t, n = /<script([^>]*)>([\s\S]*?)<\/script\s*>/ig, r = e; while ((t = n.exec(e)) != null){var i = RegExp.lastMatch; /(\s+type\s*=\s*['"]*(text|application)\/(java|ecma)script['"]*)|^((?!\s+type\s*=).)*$/i.test(RegExp.$1) && (r = r.replace(i, ""))}return r}function ew_AddScript(e, t){var n = document.createElement("SCRIPT"); return t && (n.id = t), n.type = "text/javascript", n.text = e, document.body.appendChild(n)}function ew_RemoveScript(e){e && jQuery("script[id^='scr_" + e + "_']").remove()}function ew_ElementsToRow(e){var t = jQuery, n = t(e), r = n.data("rowindex"); r = t.isValue(r)?r:""; var i = {index:r}; return n.find("[name^=x" + r + "_]").each(function(){var e = "x_" + this.name.substr(r.length + 2); t.isObject(i[e])?t.isArray(i[e])?i[e][i[e].length] = this:i[e] = [i[e], this]:i[e] = this}), i}function ew_GetRow(e){var t = jQuery, n = t(e), r = n.data("rowindex"); r = t.isValue(r)?r:""; var i = {_index:r}, s = n.find("[name^=x" + r + "_]").serializeArray(); return t.each(s, function(){var e = this.name.substr(r.length + 2).replace(/\[\]$/, ""); t.isValue(i[e])?t.isArray(i[e])?i[e][i[e].length] = this.value:i[e] = [i[e], this.value]:i[e] = this.value}), i}function ew_SaveOpt(e){var t = jQuery, n = t(e), r = n.closest("[id^=el]").find("#dsl_" + ew_GetId(e)); if (!r[0])return[]; var i = n.filter(":checked").map(function(){return this.value}).get(); return ew_ClearOpt(e), r.data("options", n.filter("[value!='{value}']").map(function(){return{val:this.value, lbl:this.nextSibling?this.nextSibling.nodeValue:""}}).get()), i}function ew_GetOptArray(e){var t = jQuery; return e.options?t(e.options).map(function(){return{value:this.value, name:this.text}}).get():e.length?t(e).filter("[value!='{value}']").map(function(){return{value:this.value, name:this.nextSibling?this.nextSibling.nodeValue:""}}).get():[]}function ew_AddOptSuccess(e){var t = jQuery, n = ewAddOptDialog, r; if (!n)return; if (e)try{r = t.parseJSON(e)} catch (i){}if (r && r.length > 0){var s = r[0], o = n.data("args").el, u = "x_", a = - 1; o.match(/^(x(\d+)_)/) && (u = RegExp.$1, a = parseInt(RegExp.$2, 10)); var f = function(e){return e.replace(/^x_/, u)}, l = ewForms(n.data("args").lnk); n.modal("hide"); var c = l.Form, h = ew_GetElements(o, c); if (h){var p = o.replace(new RegExp("^" + u), "x_"), d = l.Lists[p].LinkField, v = l.Lists[p].DisplayFields, m = l.Lists[p].FilterFields, g = l.Lists[p].ParentFields, y = d != ""?s[d]:"", b = [y]; for (var w = 0, E = v.length; w < E; w++)b[b.length] = v[w]in s?s[v[w]]:""; for (var w = 0, E = m.length; w < E; w++)b[b.length] = m[w]in s?s[m[w]]:""; if (y && v.length > 0 && b[1]){var S = ew_GetId(o, !1), x = S.replace(new RegExp("^" + u), "x_"); if (l.Lists[x].Ajax === null){var T = l.Lists[x].Options; T[T.length] = b}var N = []; for (var w = 0, E = g.length; w < E; w++)N[N.length] = ew_GetOptValues(f(g[w]), c); var C = {data:b, parents:N, valid:!0, id:ew_GetId(h), form:c}; t(document).trigger("addoption", [C]); if (C.valid){var T = ew_GetOptArray(h), k = []; !h.options && h.length && (k = ew_SaveOpt(h)); var L = ew_NewOpt(h, b, c); if (h.options)h.options[h.options.length - 1].selected = !0, t(h).change().focus();  else if (h.length){ew_RenderOpt(h), h = ew_GetElements(S, c), k.length > 0 && ew_SelectOpt(h, k); if (h.length > 0){var o = h[h.length - 1]; (o.type == "checkbox" || o.type == "radio") && t(o).click(), o.focus()}} else if (ew_IsAutoSuggest(h)){var A = ew_GetAutoSuggest(h); t(h).val(y).change(), t(A.input).val(L).focus()}var O = t(c).find("#key_count").val(); if (O > 0)for (var w = 1; w <= O; w++){if (w == a)continue; var M = ew_GetElements(p.replace(/^x/, "x" + w), c), _ = ew_GetOptArray(M), k = []; if (t.param(T) != t.param(_))continue; !M.options && M.length && (k = ew_SaveOpt(M)), ew_NewOpt(M, b, c), !M.options && M.length && (ew_RenderOpt(M), k.length > 0 && ew_SelectOpt(M, k))}}}}} else{var D, P = n.find("div.ewMessageDialog").html(""), H = t("<div></div>").html(e).find("div.ewMessageDialog"); if (H[0])D = H.html();  else{D = e; if (!D || t.trim(D) == "")D = ewLanguage.Phrase("InsertFailed"); D = '<p class="text-danger">' + D + "</p>"}P.html(D).show()}}function ew_AddOptDialogHide(){if ($dlg = ewAddOptDialog)ew_RemoveScript($dlg.data("args").el), $dlg.removeData("args").find(".modal-body form").data("form").DestroyEditor(), $dlg.find(".modal-body").html(""), $dlg.find(".modal-footer .btn-primary").unbind()}function ew_ModalDragStart(e, t){var n = jQuery, r = n(this), i = n("body"); t.limit = i.offset(), t.limit.bottom = t.limit.top + i.outerHeight() - r.outerHeight(), t.limit.right = t.limit.left + i.outerWidth() - r.outerWidth()}function ew_ModalDrag(e, t){var n = jQuery, r = n(this), i = parseInt(r.css("margin-left"), 10); r.css({top:Math.min(t.limit.bottom, Math.max(t.limit.top, t.offsetY)), left:Math.min(t.limit.right - i, Math.max(t.limit.left - i, t.offsetX - i))})}function ew_AddOptDialogShow(e){var t = jQuery, n = ewAddOptDialog || t("#ewAddOptDialog").on("hidden.bs.modal", ew_AddOptDialogHide), r = function(e){n.modal("hide"), alert("Server Error " + e.status + ": " + e.statusText)}, i = function(){var e = ewAddOptDialog, n = e.find(".modal-body form")[0], i = ewForms[n.id]; return i.UpdateTextArea(), i.Validate() && (i.DestroyEditor(), t.post(n.action, t(n).serialize(), ew_AddOptSuccess).fail(r)), !1}; n.modal("hide"), n.data("args", e); var s = function(r){var s = ewForms(e.lnk), o = "x_"; e.el.match(/^(x\d+_)/) && (o = RegExp.$1); var u = e.el.replace(o, "x_"), a = s.Lists[u].ParentFields, f = s.Lists[u].FilterFields, l = s.Form, c = []; for (var h = 0, p = a.length; h < p; h++){var d = ew_GetElements(a[h].replace(/^x_/, o), l); c[c.length] = ew_GetOptValues(d)}n.find(".modal-title").html(t(e.lnk).text()), n.find(".modal-body").html(ew_StripScript(r)); var l = n.find(".modal-body form")[0]; if (l){t(l).keypress(function(e){if (e.which == 13)return i()}); for (var h = 0, p = c.length; h < p; h++){var v = l.elements[f[h]]; v && ew_SelectOpt(v, c[h])}}ewAddOptDialog = n.modal("show"), n.find(".modal-footer .btn-primary").click(i).focus(), ew_ExecScript(r, e.el)}; t.get(e.url, s).fail(r)}function ew_SearchSuccess(e){var t = jQuery, n = ewSearchDialog, r; if (!n)return; if (e)try{r = t.parseJSON(e)} catch (i){}if (r && r.length > 0){n.modal("hide"); var s = r[0], o = s.url; window.location = o} else n.find(".modal-body").html(ew_StripScript(e))}function ew_SearchDialogHide(){if ($dlg = ewSearchDialog){ew_RemoveScript("SearchDialog"); var e = $dlg.removeData("args").find(".modal-body form").data("form"); e && e.DestroyEditor(), $dlg.find(".modal-body").html(""), $dlg.find(".modal-footer .btn-primary").unbind()}}function ew_SearchDialogShow(e){var t = jQuery, n = ewSearchDialog || t("#ewSearchDialog").on("hidden.bs.modal", ew_SearchDialogHide), r = function(e){n.modal("hide"), e.status && alert("Server Error " + e.status + ": " + e.statusText)}, i = function(){var e = ewSearchDialog, n = e.find(".modal-body form")[0], i = ewForms[n.id]; return i.UpdateTextArea(), i.Validate() && (i.DestroyEditor(), t.post(n.action, t(n).serialize(), ew_SearchSuccess).fail(r)), !1}; ew_SearchDialogHide(), n.data("args", e); var s = function(r){var s = t(r); n.find(".modal-title").html(t(e.lnk).data("caption") || t(e.lnk).data("original-title")); var o = ew_StripScript(r).match(/<body>[\s\S]*<\/body>/i); n.find(".modal-body").append(t(o[0]).not("div[id^=ew].modal, #ewTooltip")), n.find(".modal-body form").keypress(function(e){if (e.which == 13)return i()}), ewSearchDialog = n.modal("show"), n.find(".modal-footer .btn-primary").click(i).focus(), ew_ExecScript(r, "SearchDialog")}, o = e.url + "?modal=1&rnd=" + ew_Random(); t.get(o, s).fail(r)}function ew_AutoFill(e){var t = jQuery, n = e.form; if (!n)return; var r = ew_GetOptValues(e), i = ew_GetId(e), s = ew_GetElement("ln_" + i, n); if (!s || s.value == "")return; var o = s.value.split(","), u = function(r){var s = r || "", u = s?s[0]:[]; for (var a = 0; a < o.length; a++){var f = ew_GetElements(o[a], n); if (f){var l = t.isValue(u[a])?u[a]:"", c = {result:u, data:l, form:n, name:i, target:o[a], cancel:!1, trigger:!0}; t(e).trigger("autofill", [c]); if (c.cancel)continue; l = c.data, f.options || f.length && f[0].type == "radio"?ew_SelectOpt(f, l.split(",")):f.length && f[0].type == "checkbox"?ew_SelectOpt(f, l.split(",")):ew_IsAutoSuggest(f)?(f.value = l, ew_GetAutoSuggest(f).input.value = l, ew_UpdateOpt.call(ewForms[n.id], f)):ew_IsHiddenTextArea(f)?(f.value = l, t(f).data("editor").set()):f.value = l, c.trigger && t(f).change()}}}; if (r.length > 0 && r[0] != ""){var a = {ajax:"autofill", form:n.id, name:i, target:s.value, q:r[0], token:EW_TOKEN}, f = t(e).closest("div.ewForm[id^=f][id$=grid]"); f[0] && (a.grid = f.attr("id")), t.post(window.location.href.split("?")[0], a, u, "json")} else u()}function ew_Tooltip(e, t){var n = jQuery, r = n(t), i = n("#" + r.data("tooltip-id")), s = r.data("trigger") || "hover", o = r.data("placement") || (EW_CSS_FLIP?"left":"right"); if (!i[0] || n.trim(i.text()) == "" && !i.find("img[src!='']")[0])return; r.data("bs.popover") || r.popover({html:!0, placement:o, trigger:s, delay:100, container:n("#ewTooltip")[0], content:i.html()}).on("show.bs.popover", function(e){var t = r.data("bs.popover").tip(); (wd = r.data("tooltip-width")) && t.css("max-width", parseInt(wd, 10) + "px")}).on("shown.bs.popover", function(e){if (o != "left" && o != "right")return; var t = n(e.target), i = t.width(), s = t.height(), u = n(document), a = n(document.body), f = r.data("bs.popover").tip(), l = f.width(), c = f.position(), h = u.scrollTop() + a.outerHeight() - f.outerHeight(); c.top = Math.max(u.scrollTop(), Math.min(h, c.top)), f.css("top", c.top + "px"); var p = f.find(".arrow"), d = t.position().top - c.top + s / 2 - p.height(), v = (parseInt(f.css("border-top-left-radius"), 10) || 6) - parseInt(p.css("margin-top"), 10), m = f.height() - v - p.height(); p.css("top", Math.max(v, Math.min(d, m)) + "px")})}function ew_EmailDialogShow(e){var t = jQuery, n = ewEmailDialog || t("#ewEmailDialog"); if (!n)return; if (e.sel && !ew_KeySelected(e.f)){alert(ewLanguage.Phrase("NoRecordSelected")); return}var r = n.find(".modal-body form"), i = r.data("form"); i || (i = new ew_Form(r.attr("id")), i.Validate = function(){var e, t = this.GetForm(); return e = t.elements.sender, e && !ew_HasValue(e)?this.OnError(e, ewLanguage.Phrase("EnterSenderEmail")):e && !ew_CheckEmailList(e.value, 1)?this.OnError(e, ewLanguage.Phrase("EnterProperSenderEmail")):(e = t.elements.recipient, e && !ew_HasValue(e)?this.OnError(e, ewLanguage.Phrase("EnterRecipientEmail")):e && !ew_CheckEmailList(e.value, EW_MAX_EMAIL_RECIPIENT)?this.OnError(e, ewLanguage.Phrase("EnterProperRecipientEmail")):(e = t.elements.cc, e && !ew_CheckEmailList(e.value, EW_MAX_EMAIL_RECIPIENT)?this.OnError(e, ewLanguage.Phrase("EnterProperCcEmail")):(e = t.elements.bcc, e && !ew_CheckEmailList(e.value, EW_MAX_EMAIL_RECIPIENT)?this.OnError(e, ewLanguage.Phrase("EnterProperBccEmail")):(e = t.elements.subject, e && !ew_HasValue(e)?this.OnError(e, ewLanguage.Phrase("EnterSubject")):!0))))}, i.Submit = function(){if (!this.Validate())return!1; var i = r.serialize(), s = ""; e.f && e.sel && (s = t(e.f).find("input:checkbox[name='key_m[]']:checked").serialize()), e.key && (i += "&" + t.param(e.key)); var o = this.GetForm(), u = ew_GetOptValues("contenttype", o); return e.url && u == "html"?(n.modal("hide"), ew_Export(e.f, e.url, "email", !0, e.sel, o)):t.post(e.f.action, i + "&" + s, function(e){ew_ShowMessage(e)}), !0}, r.data("form", i)), n.modal("hide").find(".modal-title").html(e.hdr), n.find(".modal-footer .btn-primary").unbind().click(function(e){e.preventDefault(), i.Submit() && n.modal("hide")}), ewEmailDialog = n.modal("show")}function ew_Ajax(e, t, n){if (!e)return undefined; var r = jQuery, i = {s:e}; i = r.extend(i, r.isObject(t)?t:{q:t}); if (!r.isFunction(n)){var s = r.ajax({async:!1, type:"POST", data:i}).responseText, o = r.parseJSON(s); return o.length == 1?(o = o[0], r.isArray(o) && o.length == 1?o[0]:o):o}r.post(EW_LOOKUP_FILE_NAME, i, n, "json")}function ew_ToggleSrchOpr(e, t){var n = this.form.elements[e]; if (!n)return; n.value = n.value != t?t:"="}function ew_CheckUSDate(e){return ew_CheckDateEx(e, "us", EW_DATE_SEPARATOR)}function ew_CheckShortUSDate(e){return ew_CheckDateEx(e, "usshort", EW_DATE_SEPARATOR)}function ew_CheckDate(e){return ew_CheckDateEx(e, "std", EW_DATE_SEPARATOR)}function ew_CheckShortDate(e){return ew_CheckDateEx(e, "stdshort", EW_DATE_SEPARATOR)}function ew_CheckEuroDate(e){return ew_CheckDateEx(e, "euro", EW_DATE_SEPARATOR)}function ew_CheckShortEuroDate(e){return ew_CheckDateEx(e, "euroshort", EW_DATE_SEPARATOR)}function ew_CheckDateEx(e, t, n){if (!e || e.length == "")return!0; while (e.indexOf("  ") > - 1)e = e.replace(/  /g, " "); e = e.replace(/^\s*|\s*$/g, ""); var r = e.split(" "); if (r.length > 0){var i, s, o, u; i = /^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1])$/; if (ar = i.exec(r[0]))s = ar[1], o = ar[2], u = ar[3];  else{var a = "\\" + n; switch (t){case"std":i = new RegExp("^(\\d{4})" + a + "([0]?[1-9]|[1][0-2])" + a + "([0]?[1-9]|[1|2]\\d|[3][0|1])$"); break; case"stdshort":i = new RegExp("^(\\d{2})" + a + "([0]?[1-9]|[1][0-2])" + a + "([0]?[1-9]|[1|2]\\d|[3][0|1])$"); break; case"us":i = new RegExp("^([0]?[1-9]|[1][0-2])" + a + "([0]?[1-9]|[1|2]\\d|[3][0|1])" + a + "(\\d{4})$"); break; case"usshort":i = new RegExp("^([0]?[1-9]|[1][0-2])" + a + "([0]?[1-9]|[1|2]\\d|[3][0|1])" + a + "(\\d{2})$"); break; case"euro":i = new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])" + a + "([0]?[1-9]|[1][0-2])" + a + "(\\d{4})$"); break; case"euroshort":i = new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])" + a + "([0]?[1-9]|[1][0-2])" + a + "(\\d{2})$")}if (!i.test(r[0]))return!1; var f = r[0].split(n); switch (t){case"std":case"stdshort":s = ew_UnformatYear(f[0]), o = f[1], u = f[2]; break; case"us":case"usshort":s = ew_UnformatYear(f[2]), o = f[0], u = f[1]; break; case"euro":case"euroshort":s = ew_UnformatYear(f[2]), o = f[1], u = f[0]}}if (!ew_CheckDay(s, o, u))return!1}return r.length > 1 && !ew_CheckTime(r[1])?!1:!0}function ew_UnformatYear(e){return e.length == 2?e > EW_UNFORMAT_YEAR?"19" + e:"20" + e:e}function ew_CheckDay(e, t, n){e = parseInt(e, 10), t = parseInt(t, 10), n = parseInt(n, 10); var r = ew_InArray(t, [4, 6, 9, 11]) > - 1?30:31; return t == 2 && (r = e % 4 > 0 || e % 100 == 0 && e % 400 > 0?28:29), ew_CheckRange(n, 1, r)}function ew_CheckInteger(e){return!e || e.length == 0?!0:e.indexOf(EW_DECIMAL_POINT) > - 1?!1:ew_CheckNumber(e)}function ew_CheckNumber(e){e = String(e); if (!e || e.length == 0)return!0; e = e.replace(/^\s*|\s*$/g, ""); var t = new RegExp("^[+-]?(\\d{1,3}(" + (EW_THOUSANDS_SEP?"\\" + EW_THOUSANDS_SEP + "?":"") + "\\d{3})*(\\" + EW_DECIMAL_POINT + "\\d+)?|\\" + EW_DECIMAL_POINT + "\\d+)$"); return t.test(e)}function ew_StrToFloat(e){e = String(e); if (EW_THOUSANDS_SEP != ""){var t = new RegExp("\\" + EW_THOUSANDS_SEP, "g"); e = e.replace(t, "")}return EW_DECIMAL_POINT != "" && (e = e.replace(EW_DECIMAL_POINT, ".")), parseFloat(e)}function ew_StrToDate(e){var t = /^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/, n = e.replace(t, "$1 $2 $3 $4 $5 $6").split(" "); return new Date(n[0], n[1] - 1, n[2], n[3], n[4], n[5])}function ew_CheckRange(e, t, n){if (!e || e.length == 0)return!0; var r = jQuery; return(r.isNumber(t) || r.isNumber(n)) && ew_CheckNumber(e) && (e = ew_StrToFloat(e)), !r.isNull(t) && e < t?!1:!r.isNull(n) && e > n?!1:!0}function ew_CheckTime(e){if (!e || e.length == 0)return!0; e = e.replace(/^\s*|\s*$/g, ""); var t = /^(0\d|1\d|2[0-3]):[0-5]\d(:[0-5]\d)?$/; return t.test(e)}function ew_CheckPhone(e){if (!e || e.length == 0)return!0; e = e.replace(/^\s*|\s*$/g, ""); var t = /^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/; return t.test(e)}function ew_CheckZip(e){if (!e || e.length == 0)return!0; e = e.replace(/^\s*|\s*$/g, ""); var t = /^\d{5}$|^\d{5}-\d{4}$/; return t.test(e)}function ew_CheckCreditCard(e){if (!e || e.length == 0)return!0; var t = e.replace(/\D/g, ""); if (t.length == 0)return!1; var n = t.length % 2 == 1?!1:!0, r, i = 0; for (var s = 0, o = t.length; s < o; s++)r = parseInt(t.charAt(s), 10), n?(r *= 2, i += r % 10, r / 10 >= 1 && i++, n = !1):(i += r, n = !0); return i % 10 == 0}function ew_CheckSSC(e){if (!e || e.length == 0)return!0; e = e.replace(/^\s*|\s*$/g, ""); var t = /^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/; return t.test(e)}function ew_CheckEmailList(e, t){if (!e || e.length == 0)return!0; var n = e.replace(/,/g, ";").split(";"); for (var r = 0, i = n.length; r < i; r++){if (t > 0 && i > t)return!1; if (!ew_CheckEmail(n[r]))return!1}return!0}function ew_CheckEmail(e){if (!e || e.length == 0)return!0; e = e.replace(/^\s*|\s*$/g, ""); var t = /^[\w.%+-]+@[\w.-]+\.[A-Z]{2,6}$/i; return t.test(e)}function ew_CheckGUID(e){if (!e || e.length == 0)return!0; e = e.replace(/^\s*|\s*$/g, ""); var t = /^\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}$/, n = /^\w{8}-\w{4}-\w{4}-\w{4}-\w{12}$/; return t.test(e) || n.test(e)}function ew_CheckByRegEx(e, t){return!e || e.length == 0?!0:e.match(t)?!0:!1}function ew_ShowMessage(e){if (window.location != window.parent.location && parent.ew_ShowMessage)return parent.ew_ShowMessage(e); var t = jQuery, n = t("div.ewMessageDialog:first"), r = e || (n.length?EW_IS_MOBILE?n.text():n.html():""); if (t.trim(r) == "")return; if (EW_IS_MOBILE)alert(r);  else{var i = t("#ewMsgBox"); i.find(".modal-body").html(r), i.modal("show")}}function ew_Random(){return Math.floor(Math.random() * 100001) + 1e5}function ew_Upload(e, t){var n = jQuery, r = n(t); if (r.data("blueimpFileupload"))return; var i = r.attr("name"), s = i.replace(/\$/g, "\\$"), o = r.is("[multiple]"), u = r.closest(".form-group,[id^='el_']"), a = u.find(".btn").css("display") == "none" || r.closest("form").find("#a_confirm").val() == "F", f = u.find("#ft_" + s), l = u.find("#fn_" + s), c = u.find("#fa_" + s), h = u.find("#fs_" + s), p = u.find("#fx_" + s), d = u.find("#fm_" + s), v = u.find("#fc_" + s), m = function(e, t){if (t.result.files[0].error)return; var n = t.result.files[0].name, r = o?l.val()?l.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[]:[]; r[r.length] = n, l.val(r.join(EW_MULTIPLE_UPLOAD_SEPARATOR)), c.val("0"), o || f.find("tr:not(:last)").remove()}, g = function(e, t){var r = {}, i = n(e.originalEvent.target).data("url"); i && i.replace(/(?:\?|&)([^&=]*)=?([^&]*)/g, function(e, t, n){t && (r[t] = n)}); var s = r.id, o = r[s]; if (s && r[s]){var o = r[s], u = l.val()?l.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[]; n.each(u, function(e, t){if (t == decodeURIComponent(o))return u.splice(e, 1), !1}), l.val(u.join(EW_MULTIPLE_UPLOAD_SEPARATOR)), c.val("0")}}, y = function(e, t){var r = l.val()?l.val().split(EW_MULTIPLE_UPLOAD_SEPARATOR):[]; for (var i = 0; i < t.files.length; i++)r[r.length] = t.files[i].name; var s = parseInt(v.val(), 10); if (n.isNumber(s) && r.length > s)return alert(ewLanguage.Phrase("UploadErrMsgMaxNumberOfFiles")), !1; var o = parseInt(h.val(), 10); if (n.isNumber(o) && o > 0 && r.join(EW_MULTIPLE_UPLOAD_SEPARATOR).length > o)return alert(ewLanguage.Phrase("UploadErrMsgMaxFileLength")), !1}, b = function(e){!o && l.val() && (confirm(ewLanguage.Phrase("UploadOverwrite")) || (e.preventDefault(), e.stopPropagation()))}, w = function(e){var t = n(); return n.each(e.files, function(r, i){var s = n('<tr class="template-upload fade"><td class="preview"><span class="fade"></span></td><td class="name"></td><td class="size"></td>' + (i.error?'<td class="error text-danger" colspan="2"></td>':'<td><div class="progress"><div class="bar" style="width: 0%;"></div></div></td><td><button type="button" class="btn btn-default btn-sm start">' + ewLanguage.Phrase("UploadStart") + "</button></td>") + '<td><button type="button" class="btn btn-default btn-sm cancel">' + ewLanguage.Phrase("UploadCancel") + "</button></td></tr>"); s.find(".name").text(i.name), s.find(".size").text(e.formatFileSize(i.size)), s.find(".start").click(b), s.find(".error").text(i.error), t = t.add(s)}), t}, E = function(e){var t = n(); return n.each(e.files, function(r, i){var s = n('<tr class="template-download fade">' + (i.error?'<td></td><td class="name"></td><td class="size"></td><td class="error text-danger" colspan="2"></td>':'<td class="preview"></td><td class="name"><a></a></td><td class="size"></td><td colspan="2"></td>') + (a?"":'<td><button type="button" class="btn btn-default btn-sm delete">' + ewLanguage.Phrase("UploadDelete") + "</button></td>") + "</tr>"); s.find(".size").text(e.formatFileSize(i.size)); if (i.error)s.find(".name").text(i.name), s.find(".error").text(i.error), i.deleteUrl || s.find(".delete").click(function(){n(this).closest(".template-download").remove(), S()});  else{var o = s.find(".name a").text(i.name); i.url && o.attr("href", i.url).attr("target", "_blank"), i.thumbnailUrl && /\.(bmp|gif|jpe?g|png)$/i.test(i.name) && (EW_USE_COLORBOX && o.colorbox(ewLightboxSettings), s.find(".preview").append('<a><img style="width: ' + EW_UPLOAD_THUMBNAIL_WIDTH + 'px;"></a>').find("img").prop("src", i.thumbnailUrl)), s.find(".delete").attr("data-type", i.deleteType).attr("data-url", i.deleteUrl)}t = t.add(s)}), t}, S = function(){f.css("margin-top", f.find("tr")[0] && !a?"10px":"0")}, x = function(){r.closest("span.fileinput-button").tooltip("hide")}, T = function(e, t){t.files && t.files.error && alert(t.files[0].error)}, N = ew_GetForm(t), C = n(N), k = C.find("#a_confirm").val() == "F"; k && C.find("span.fileinput-button").hide(); var L = parseInt(v.val(), 10); r.fileupload({url:EW_UPLOAD_URL, autoUpload:!0, loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i, acceptFileTypes:new RegExp("\\.(" + p.val().replace(/,/g, "|") + ")$", "i"), maxFileSize:parseInt(d.val(), 10), maxNumberOfFiles:L > 1?L:null, filesContainer:f, formData:{id:i, replace:o?"0":"1", exts:p.val(), maxsize:d.val(), maxfilecount:v.val()}, uploadTemplateId:null, downloadTemplateId:null, uploadTemplate:w, downloadTemplate:E, previewMaxWidth:EW_UPLOAD_THUMBNAIL_WIDTH, previewMaxHeight:EW_UPLOAD_THUMBNAIL_HEIGHT, dropZone:u, pasteZone:u, messages:{acceptFileTypes:ewLanguage.Phrase("UploadErrMsgAcceptFileTypes"), maxFileSize:ewLanguage.Phrase("UploadErrMsgMaxFileSize"), maxNumberOfFiles:ewLanguage.Phrase("UploadErrMsgMaxNumberOfFiles"), minFileSize:ewLanguage.Phrase("UploadErrMsgMinFileSize")}}).on("fileuploaddone", m).on("fileuploaddestroy", g).on("fileuploadchange", y).on("fileuploadadded fileuploadfinished fileuploaddestroyed", S).on("fileuploadprocessfail", T).click(x), l.val() && n.ajax({url:EW_UPLOAD_URL, data:{id:i}, dataType:"json", context:this, success:function(e){e && e[i] && r.fileupload("option", "done").call(t, n.Event(), {result:{files:e[i]}}), k && f.find("td.delete").hide()}})}function ew_UserAgent(e){var t = function(e){var t = 0; return parseFloat(e.replace(/\./g, function(){return t++ === 1?"":"."}))}, n = window, r = n && n.navigator, i = {ie:0, opera:0, gecko:0, webkit:0, safari:0, chrome:0, mobile:null, air:0, phantomjs:0, ipad:0, iphone:0, ipod:0, ios:null, android:0, silk:0, ubuntu:0, accel:!1, webos:0, caja:r && r.cajaVersion, secure:!1, os:null, nodejs:0, winjs:typeof Windows != "undefined" && !!Windows.System, touchEnabled:!1}, s = e || r && r.userAgent, o = n && n.location, u = o && o.href, a; return i.userAgent = s, i.secure = u && u.toLowerCase().indexOf("https") === 0, s && (/windows|win32/i.test(s)?i.os = "windows":/macintosh|mac_powerpc/i.test(s)?i.os = "macintosh":/android/i.test(s)?i.os = "android":/symbos/i.test(s)?i.os = "symbos":/linux/i.test(s)?i.os = "linux":/rhino/i.test(s) && (i.os = "rhino"), /KHTML/.test(s) && (i.webkit = 1), /IEMobile|XBLWP7/.test(s) && (i.mobile = "windows"), /Fennec/.test(s) && (i.mobile = "gecko"), a = s.match(/AppleWebKit\/([^\s]*)/), a && a[1] && (i.webkit = t(a[1]), i.safari = i.webkit, /PhantomJS/.test(s) && (a = s.match(/PhantomJS\/([^\s]*)/), a && a[1] && (i.phantomjs = t(a[1]))), / Mobile\//.test(s) || /iPad|iPod|iPhone/.test(s)?(i.mobile = "Apple", a = s.match(/OS ([^\s]*)/), a && a[1] && (a = t(a[1].replace("_", "."))), i.ios = a, i.os = "ios", i.ipad = i.ipod = i.iphone = 0, a = s.match(/iPad|iPod|iPhone/), a && a[0] && (i[a[0].toLowerCase()] = i.ios)):(a = s.match(/NokiaN[^\/]*|webOS\/\d\.\d/), a && (i.mobile = a[0]), /webOS/.test(s) && (i.mobile = "WebOS", a = s.match(/webOS\/([^\s]*);/), a && a[1] && (i.webos = t(a[1]))), / Android/.test(s) && (i.mobile = "Android", a = s.match(/Android ([^\s]*);/), a && a[1] && (i.android = t(a[1]))), /Silk/.test(s) && (a = s.match(/Silk\/([^\s]*)/), a && a[1] && (i.silk = t(a[1])), i.android || (i.android = 2.34, i.os = "Android"), /Accelerated=true/.test(s) && (i.accel = !0))), a = s.match(/OPR\/(\d+\.\d+)/), a && a[1]?i.opera = t(a[1]):(a = s.match(/(Chrome|CrMo|CriOS)\/([^\s]*)/), a && a[1] && a[2]?(i.chrome = t(a[2]), i.safari = 0, a[1] === "CrMo" && (i.mobile = "chrome")):(a = s.match(/AdobeAIR\/([^\s]*)/), a && (i.air = a[0])))), a = s.match(/Ubuntu\ (\d+\.\d+)/), a && a[1] && (i.os = "linux", i.ubuntu = t(a[1]), a = s.match(/\ WebKit\/([^\s]*)/), a && a[1] && (i.webkit = t(a[1])), a = s.match(/\ Chromium\/([^\s]*)/), a && a[1] && (i.chrome = t(a[1])), / Mobile$/.test(s) && (i.mobile = "Ubuntu")), i.webkit || (/Opera/.test(s)?(a = s.match(/Opera[\s\/]([^\s]*)/), a && a[1] && (i.opera = t(a[1])), a = s.match(/Version\/([^\s]*)/), a && a[1] && (i.opera = t(a[1])), /Opera Mobi/.test(s) && (i.mobile = "opera", a = s.replace("Opera Mobi", "").match(/Opera ([^\s]*)/), a && a[1] && (i.opera = t(a[1]))), a = s.match(/Opera Mini[^;]*/), a && (i.mobile = a[0])):(a = s.match(/MSIE ([^;]*)|Trident.*; rv:([0-9.]+)/), a && (a[1] || a[2])?i.ie = t(a[1] || a[2]):(a = s.match(/Gecko\/([^\s]*)/), a && (i.gecko = 1, a = s.match(/rv:([^\s\)]*)/), a && a[1] && (i.gecko = t(a[1]), /Mobile|Tablet/.test(s) && (i.mobile = "ffos"))))))), n && r && !(i.chrome && i.chrome < 6) && (i.touchEnabled = "ontouchstart"in n || "msMaxTouchPoints"in r && r.msMaxTouchPoints > 0), e || typeof process == "object" && process.versions && process.versions.node && (i.os = process.platform, i.nodejs = t(process.versions.node)), i}var ewAddOptDialog, ewEmailDialog, $rowindex$ = null, ewSearchDialog, EW_TABLE_CLASSNAME = "ewTable", EW_GRID_CLASSNAME = "ewGrid", EW_MULTI_COLUMN_GRID_CLASSNAME = "ewMultiColumnGrid", EW_TABLE_ROW_CLASSNAME = "ewTableRow", EW_TABLE_ALT_ROW_CLASSNAME = "ewTableAltRow", EW_ITEM_TEMPLATE_CLASSNAME = "ewTemplate", EW_ITEM_TABLE_CLASSNAME = "ewItemTable", EW_TABLE_LAST_ROW_CLASSNAME = "ewTableLastRow", EW_TABLE_LAST_COL_CLASSNAME = "ewTableLastCol", EW_TABLE_PREVIEW_ROW_CLASSNAME = "ewTablePreviewRow", EW_TABLE_EDIT_ROW_CLASSNAME = "ewTableEditRow", EW_TABLE_SELECT_ROW_CLASSNAME = "ewTableSelectRow", EW_TABLE_HIGHLIGHT_ROW_CLASSNAME = "ewTableHighlightRow", EW_TABLE_BORDER_BOTTOM_CLASSNAME = "ewTableBorderBottom", EW_REPORT_CONTAINER_ID = "ewContainer", EW_ROWTYPE_ADD = 2, EW_ROWTYPE_EDIT = 3, EW_UNFORMAT_YEAR = 50, ew_ClientScriptInclude = jQuery.getScript, ewLightboxSettings = {transition:"none", photo:!0, opacity:.5}; jQuery(document).on("addoption", ew_DefaultLookup), jQuery(function(e){e("input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]").each(function(){var t = e(this); t.tooltip(e.extend({html:!0, placement:"bottom"}, t.data()))}), e("a.ewTooltipLink").each(ew_Tooltip), ew_InitIcons(), e.extend(ewLightboxSettings, {title:ewLanguage.Phrase("LightboxTitle"), current:ewLanguage.Phrase("LightboxCurrent"), previous:ewLanguage.Phrase("LightboxPrevious"), next:ewLanguage.Phrase("LightboxNext"), close:ewLanguage.Phrase("LightboxClose"), xhrError:ewLanguage.Phrase("LightboxXhrError"), imgError:ewLanguage.Phrase("LightboxImgError")}), e(".ewLightbox").each(function(){var t = e(this); t.colorbox(e.extend({rel:t.data("rel")}, ewLightboxSettings))}), e("table." + EW_TABLE_CLASSNAME + ":not(.ewExportTable):not(#" + EW_REPORT_CONTAINER_ID + " table)").each(ew_SetupTable), e("table." + EW_GRID_CLASSNAME + ":not(.ewExportTable):not(#" + EW_REPORT_CONTAINER_ID + " table)").each(ew_SetupGrid), e.later(e("textarea.editor")[0]?250:0, null, function(){var t = e(window), n = e("#ewContentTable"), r = e("body").height(); n.css("min-height", n.outerHeight()), t.resize(function(){t.height() > r && n.css("height", t.height() - (e("#ewHeaderRow").is(":hidden")?0:e("#ewHeaderRow").height()) - (e("#ewMobileMenu").is(":hidden")?0:e("#ewMobileMenu").height()) - (e("#ewMenuRow").is(":hidden")?0:e("#ewMenuRow").height()) - (e("#ewFooterRow").is(":hidden")?0:e("#ewFooterRow").height()))}).triggerHandler("resize")}), e("input[name=pageno]").keypress(function(e){if (e.which == 13){var t = window.location.href, n = t.lastIndexOf(window.location.search); return window.location = t.substr(0, n) + "?" + this.name + "=" + parseInt(this.value), !1}}), e(window).width() < 768 && e(".table-responsive [data-toggle='dropdown']").parent().on("shown.bs.dropdown", function(){var t = e(this), n = t.find(".dropdown-menu"), r = t.closest(".table-responsive")[0]; if (r.scrollHeight - r.clientHeight){var i = n.offset().top + n.outerHeight() - e(r).offset().top - r.clientHeight; i > 0 && n.css(EW_CSS_FLIP?"right":"left", "100%").css("top", parseFloat(n.css("top")) - i)}}), typeof EW_USE_JAVASCRIPT_MESSAGE != "undefined" && EW_USE_JAVASCRIPT_MESSAGE && ew_ShowMessage()}); var ewEvent = {on:ew_On}, ewForms = function(e){if (e){var t = jQuery, n; t.isString(e)?n = e:n = t(ew_GetForm(e)).attr("id"); if (n && ewForms[n])return ewForms[n]}return undefined}; jQuery.extend({isBoolean:function(e){return typeof e == "boolean"}, isNull:function(e){return e === null}, isNumber:function(e){return typeof e == "number" && isFinite(e)}, isObject:function(e){return e && (typeof e == "object" || this.isFunction(e)) || !1}, isString:function(e){return typeof e == "string"}, isUndefined:function(e){return typeof e == "undefined"}, isValue:function(e){return this.isObject(e) || this.isString(e) || this.isNumber(e) || this.isBoolean(e)}, isDate:function(e){return this.type(e) === "date" && e.toString() !== "Invalid Date" && !isNaN(e)}, later:function(e, t, n, r, i){e = e || 0, t = t || {}; var s = n, o = r, u, a; this.isString(n) && (s = t[n]); if (!s)return; return!this.isUndefined(r) && !this.isArray(o) && (o = [r]), u = function(){s.apply(t, o || [])}, a = i?setInterval(u, e):setTimeout(u, e), {interval:i, cancel:function(){this.interval?clearInterval(a):clearTimeout(a)}}}, ua:ew_UserAgent()}), + function(e){"use strict"; function i(r){if (r && r.which === 3)return; e(t).remove(), e(n, e(r.currentTarget).is(n)?e(r.currentTarget).parent():document).each(function(){var t = s(e(this)), n = {relatedTarget:this}; if (!t.hasClass("open"))return; t.trigger(r = e.Event("hide.bs.dropdown", n)); if (r.isDefaultPrevented())return; t.removeClass("open").trigger("hidden.bs.dropdown", n)})}function s(t){var n = t.attr("data-target"); n || (n = t.attr("href"), n = n && /#[A-Za-z]/.test(n) && n.replace(/.*(?=#[^\s]*$)/, "")); var r = n && e(n); return r && r.length?r:t.parent()}var t = ".dropdown-backdrop", n = ".ewDropdown", r = function(t){e(t).on("click.bs.dropdown", this.toggle)}; r.prototype.toggle = function(t){var n = e(this); if (n.is(".disabled, :disabled"))return; var r = s(n), o = r.hasClass("open"); i(t); if (!o){"ontouchstart"in document.documentElement && !r.closest(".navbar-nav").length && e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click", i); var u = {relatedTarget:this}; r.trigger(t = e.Event("show.bs.dropdown", u)); if (t.isDefaultPrevented())return; n.trigger("focus"), r.toggleClass("open").trigger("shown.bs.dropdown", u); var a = n.next(); a.is("ul.dropdown-menu") && a.find("> li > a").css("padding-left", parseInt(n.css("padding-left"), 10) + 10 + "px")}return!1}, r.prototype.keydown = function(t){if (!/(38|40|27)/.test(t.keyCode))return; var r = e(this); t.preventDefault(), t.stopPropagation(); if (r.is(".disabled, :disabled"))return; var i = s(r), o = i.hasClass("open"); if (!o || o && t.keyCode == 27)return t.which == 27 && i.find(n).trigger("focus"), r.trigger("click"); var u = " li:not(.divider):visible a", a = i.find('[role="menu"]' + u + ', [role="listbox"]' + u); if (!a.length)return; var f = a.index(a.filter(":focus")); t.keyCode == 38 && f > 0 && f--, t.keyCode == 40 && f < a.length - 1 && f++, ~f || (f = 0), a.eq(f).trigger("focus")}; var o = e.fn.dropdown; e.fn.dropdown = function(t){return this.each(function(){var n = e(this), i = n.data("bs.dropdown"); i || n.data("bs.dropdown", i = new r(this)), typeof t == "string" && i[t].call(n)})}, e.fn.dropdown.Constructor = r, e.fn.dropdown.noConflict = function(){return e.fn.dropdown = o, this}, e(document).on("click.bs.dropdown.data-api", i).on("click.bs.dropdown.data-api", ".dropdown form", function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api", n, r.prototype.toggle).on("keydown.bs.dropdown.data-api", n + ', [role="menu"], [role="listbox"]', r.prototype.keydown)}(jQuery), function(e){e.fn.drag = function(e, t, n){var r = typeof e == "string"?e:"", i = jQuery.isFunction(e)?e:jQuery.isFunction(t)?t:null; return r.indexOf("drag") !== 0 && (r = "drag" + r), n = (e == i?t:n) || {}, i?this.bind(r, n, i):this.trigger(r)}; var t = e.event, n = t.special, r = n.drag = {defaults:{which:1, distance:0, not:":input", handle:null, relative:!1, drop:!0, click:!1}, datakey:"dragdata", noBubble:!0, add:function(t){var n = e.data(this, r.datakey), i = t.data || {}; n.related += 1, e.each(r.defaults, function(e, t){i[e] !== undefined && (n[e] = i[e])})}, remove:function(){e.data(this, r.datakey).related -= 1}, setup:function(){if (e.data(this, r.datakey))return; var n = e.extend({related:0}, r.defaults); e.data(this, r.datakey, n), t.add(this, "touchstart mousedown", r.init, n), this.attachEvent && this.attachEvent("ondragstart", r.dontstart)}, teardown:function(){var n = e.data(this, r.datakey) || {}; if (n.related)return; e.removeData(this, r.datakey), t.remove(this, "touchstart mousedown", r.init), r.textselect(!0), this.detachEvent && this.detachEvent("ondragstart", r.dontstart)}, init:function(i){if (r.touched)return; var s = i.data, o; if (i.which != 0 && s.which > 0 && i.which != s.which)return; if (e(i.target).is(s.not))return; if (s.handle && !e(i.target).closest(s.handle, i.currentTarget).length)return; r.touched = i.type == "touchstart"?this:null, s.propagates = 1, s.mousedown = this, s.interactions = [r.interaction(this, s)], s.target = i.target, s.pageX = i.pageX, s.pageY = i.pageY, s.dragging = null, o = r.hijack(i, "draginit", s); if (!s.propagates)return; o = r.flatten(o), o && o.length && (s.interactions = [], e.each(o, function(){s.interactions.push(r.interaction(this, s))})), s.propagates = s.interactions.length, s.drop !== !1 && n.drop && n.drop.handler(i, s), r.textselect(!1), r.touched?t.add(r.touched, "touchmove touchend", r.handler, s):t.add(document, "mousemove mouseup", r.handler, s); if (!r.touched || s.live)return!1}, interaction:function(t, n){var i = e(t)[n.relative?"position":"offset"]() || {top:0, left:0}; return{drag:t, callback:new r.callback, droppable:[], offset:i}}, handler:function(i){var s = i.data; switch (i.type){case!s.dragging && "touchmove":i.preventDefault(); case!s.dragging && "mousemove":if (Math.pow(i.pageX - s.pageX, 2) + Math.pow(i.pageY - s.pageY, 2) < Math.pow(s.distance, 2))break; i.target = s.target, r.hijack(i, "dragstart"
        , s), s.propagates && (s.dragging = !0); case"touchmove":i.preventDefault(); case"mousemove":if (s.dragging){r.hijack(i, "drag", s); if (s.propagates){s.drop !== !1 && n.drop && n.drop.handler(i, s); break}i.type = "mouseup"}; case"touchend":case"mouseup":default:r.touched?t.remove(r.touched, "touchmove touchend", r.handler):t.remove(document, "mousemove mouseup", r.handler), s.dragging && (s.drop !== !1 && n.drop && n.drop.handler(i, s), r.hijack(i, "dragend", s)), r.textselect(!0), s.click === !1 && s.dragging && e.data(s.mousedown, "suppress.click", (new Date).getTime() + 5), s.dragging = r.touched = !1}}, hijack:function(n, i, s, o, u){if (!s)return; var a = {event:n.originalEvent, type:n.type}, f = i.indexOf("drop")?"drag":"drop", l, c = o || 0, h, p, d, v = isNaN(o)?s.interactions.length:o; n.type = i, n.originalEvent = null, s.results = []; do if (h = s.interactions[c]){if (i !== "dragend" && h.cancelled)continue; d = r.properties(n, s, h), h.results = [], e(u || h[f] || s.droppable).each(function(o, u){d.target = u, n.isPropagationStopped = function(){return!1}, l = u?t.dispatch.call(u, n, d):null, l === !1?(f == "drag" && (h.cancelled = !0, s.propagates -= 1), i == "drop" && (h[f][o] = null)):i == "dropinit" && h.droppable.push(r.element(l) || u), i == "dragstart" && (h.proxy = e(r.element(l) || h.drag)[0]), h.results.push(l), delete n.result; if (i !== "dropinit")return l}), s.results[c] = r.flatten(h.results), i == "dropinit" && (h.droppable = r.flatten(h.droppable)), i == "dragstart" && !h.cancelled && d.update()}while (++c < v); return n.type = a.type, n.originalEvent = a.event, r.flatten(s.results)}, properties:function(e, t, n){var i = n.callback; return i.drag = n.drag, i.proxy = n.proxy || n.drag, i.startX = t.pageX, i.startY = t.pageY, i.deltaX = e.pageX - t.pageX, i.deltaY = e.pageY - t.pageY, i.originalX = n.offset.left, i.originalY = n.offset.top, i.offsetX = i.originalX + i.deltaX, i.offsetY = i.originalY + i.deltaY, i.drop = r.flatten((n.drop || []).slice()), i.available = r.flatten((n.droppable || []).slice()), i}, element:function(e){if (e && (e.jquery || e.nodeType == 1))return e}, flatten:function(t){return e.map(t, function(t){return t && t.jquery?e.makeArray(t):t && t.length?r.flatten(t):t})}, textselect:function(t){e(document)[t?"unbind":"bind"]("selectstart", r.dontstart).css("MozUserSelect", t?"":"none"), document.unselectable = t?"off":"on"}, dontstart:function(){return!1}, callback:function(){}}; r.callback.prototype = {update:function(){n.drop && this.available.length && e.each(this.available, function(e){n.drop.locate(this, e)})}}; var i = t.dispatch; t.dispatch = function(t){if (e.data(this, "suppress." + t.type) - (new Date).getTime() > 0){e.removeData(this, "suppress." + t.type); return}return i.apply(this, arguments)}; var s = t.fixHooks.touchstart = t.fixHooks.touchmove = t.fixHooks.touchend = t.fixHooks.touchcancel = {props:"clientX clientY pageX pageY screenX screenY".split(" "), filter:function(t, n){if (n){var r = n.touches && n.touches[0] || n.changedTouches && n.changedTouches[0] || null; r && e.each(s.props, function(e, n){t[n] = r[n]})}return t}}; n.draginit = n.dragstart = n.dragend = r}(jQuery);